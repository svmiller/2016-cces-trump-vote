theme_steve() +
geom_errorbar(aes(ymin = lb, ymax = ub), alpha = 0.5, linetype = 1, width=.25) +
geom_line(aes(colour = Category, linetype = Category), size = 1) +
geom_point(aes(colour = Category)) +
#  geom_line(aes(x=z_age), size = 1, color="red", linetype="dashed") +
ylab("Predicted Probability of a Trump Vote") +
xlab("Range of Family Income") +
theme(legend.position="bottom") +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by=.1)) +
scale_x_continuous(breaks=c(seq(1, 16, by=1)), limits=c(0,17)) +
geom_hline(aes(yintercept=.5), linetype="dashed") +
ggtitle("Vote for Trump (All Voters, by Family Income)") +
labs(caption="1 = Less than $10,000 | 2 = $10,000 - $19,999 | 3 = $20,000 - $29,999 | 4 = $30,000 - $39,999 | 5 = $40,000 - $49,999 | 6 = $50,000 - $59,999 | 7 = $60,000 - $69,999 | 8 = $70,000 - $79,999
9 = $80,000 - $99,999 | 10 = $100,000 - $119,999 | 11 = $120,000 - $149,999 | 12 = $150,000 - $199,999 | 13 = $200,000 - $249,999 | 14 = $250,000 - $349,999 | 15 = $350,000 - $499,999, 16 = $500,000 or more")
ggplot(m1_predvalues_age, aes(x = age, y = pp)) +
theme_steve() +
geom_errorbar(aes(ymin = lb, ymax = ub), alpha = 0.3, linetype = 1) +
geom_line(aes(colour = Category, linetype = Category), size = 1) +
#  geom_line(aes(x=z_age), size = 1, color="red", linetype="dashed") +
ylab("Predicted Probability of a Trump Vote") +
xlab("Range of Age") +
theme(legend.position="bottom") +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by=.1)) +
scale_x_continuous(breaks=c(seq(20, 100, by=5)), limits=c(18,100)) +
geom_hline(aes(yintercept=.5), linetype="dashed") +
ggtitle("Vote for Trump (All Voters, by Age)")
m1p_age <- ggplot(m1_predvalues_age, aes(x = age, y = pp)) +
theme_steve() +
geom_errorbar(aes(ymin = lb, ymax = ub), alpha = 0.3, linetype = 1) +
geom_line(aes(colour = Category, linetype = Category), size = 1) +
#  geom_line(aes(x=z_age), size = 1, color="red", linetype="dashed") +
ylab("Predicted Probability of a Trump Vote") +
xlab("Range of Age") +
theme(legend.position="bottom") +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by=.1)) +
scale_x_continuous(breaks=c(seq(20, 100, by=5)), limits=c(18,100)) +
geom_hline(aes(yintercept=.5), linetype="dashed") +
ggtitle("Vote for Trump (All Voters, by Age)")
m1p_faminc <- ggplot(m1_predvalues_faminc, aes(x = famincr, y = pp)) +
theme_steve() +
geom_errorbar(aes(ymin = lb, ymax = ub), alpha = 0.5, linetype = 1, width=.25) +
geom_line(aes(colour = Category, linetype = Category), size = 1) +
geom_point(aes(colour = Category)) +
#  geom_line(aes(x=z_age), size = 1, color="red", linetype="dashed") +
ylab("Predicted Probability of a Trump Vote") +
xlab("Range of Family Income") +
theme(legend.position="bottom") +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by=.1)) +
scale_x_continuous(breaks=c(seq(1, 16, by=1)), limits=c(0,17)) +
geom_hline(aes(yintercept=.5), linetype="dashed") +
ggtitle("Vote for Trump (All Voters, by Family Income)") +
labs(caption="1 = Less than $10,000 | 2 = $10,000 - $19,999 | 3 = $20,000 - $29,999 | 4 = $30,000 - $39,999 | 5 = $40,000 - $49,999 | 6 = $50,000 - $59,999 | 7 = $60,000 - $69,999 | 8 = $70,000 - $79,999
9 = $80,000 - $99,999 | 10 = $100,000 - $119,999 | 11 = $120,000 - $149,999 | 12 = $150,000 - $199,999 | 13 = $200,000 - $249,999 | 14 = $250,000 - $349,999 | 15 = $350,000 - $499,999 | 16 = $500,000 or more")
multiplot(m1p_age, m1p_faminc)
multiplot(m1p_age, m1p_faminc, cols=2)
m1_newdat_age <- with(Data,
data.frame(z_age=rep(seq(min(z_age), max(z_age), length.out=300), 3),
female=1,
collegeed=0, z_famincr=0,
"I(z_famincr^2)"=0,black=0,
hisplat=0, otherrace=0,
z_pid7na=c(rep(unique(Data$z_pid7na)[7], 300),
rep(median(Data$z_pid7na, na.rm=T), 300),
rep(unique(Data$z_pid7na)[1], 300)),
z_ideo=median(Data$z_ideo, na.rm=TRUE),
z_lrelig=0,
z_lcograc=rep(seq(min(z_lcograc, na.rm=T), max(z_lcograc, na.rm=T), length.out=300), 3),
z_lemprac=0
)
)
m1_newdat_cograc <- with(Data,
data.frame(z_age=rep(seq(min(z_age), max(z_age), length.out=300), 3),
female=1,
collegeed=0, z_famincr=0,
"I(z_famincr^2)"=0,black=0,
hisplat=0, otherrace=0,
z_pid7na=c(rep(unique(Data$z_pid7na)[7], 300),
rep(median(Data$z_pid7na, na.rm=T), 300),
rep(unique(Data$z_pid7na)[1], 300)),
z_ideo=median(Data$z_ideo, na.rm=TRUE),
z_lrelig=0,
z_lcograc=rep(seq(min(z_lcograc, na.rm=T), max(z_lcograc, na.rm=T), length.out=300), 3),
z_lemprac=0
)
)
m1_newdat_cograc <- with(Data,
data.frame(z_age=0,
"I(z_age^2)"=0
female=1,
collegeed=0, z_famincr=0,
"I(z_famincr^2)"=0,black=0,
hisplat=0, otherrace=0,
z_pid7na=c(rep(unique(Data$z_pid7na)[7], 300),
rep(median(Data$z_pid7na, na.rm=T), 300),
rep(unique(Data$z_pid7na)[1], 300)),
z_ideo=median(Data$z_ideo, na.rm=TRUE),
z_lrelig=0,
z_lcograc=rep(seq(min(z_lcograc, na.rm=T), max(z_lcograc, na.rm=T), length.out=300), 3),
z_lemprac=0
)
)
m1_newdat_cograc <- with(Data,
data.frame(z_age=0,
"I(z_age^2)"=0,
female=1,
collegeed=0, z_famincr=0,
"I(z_famincr^2)"=0,black=0,
hisplat=0, otherrace=0,
z_pid7na=c(rep(unique(Data$z_pid7na)[7], 300),
rep(median(Data$z_pid7na, na.rm=T), 300),
rep(unique(Data$z_pid7na)[1], 300)),
z_ideo=median(Data$z_ideo, na.rm=TRUE),
z_lrelig=0,
z_lcograc=rep(seq(min(z_lcograc, na.rm=T), max(z_lcograc, na.rm=T), length.out=300), 3),
z_lemprac=0
)
)
m1_predvalues_cograc <- cbind(m1_newdat_cograc, predictSE(M1, newdata = m1_newdat_cograc,
type = "link", se.fit = TRUE, re.form=NA))
m1_predvalues_cograc$pp <- with(m1_predvalues_cograc, plogis(fit))
m1_predvalues_cograc$lb <- with(m1_predvalues_cograc, plogis(fit - (1.96 * se.fit)))
m1_predvalues_cograc$ub <- with(m1_predvalues_cograc, plogis(fit + (1.96 * se.fit)))
m1_predvalues_cograc$Category <- NA
m1_predvalues_cograc$Category[m1_predvalues_cograc$z_pid7na == unique(Data$z_pid7na)[7]] <- "Independent, lean Democrat"
m1_predvalues_cograc$Category[m1_predvalues_cograc$z_pid7na == unique(Data$z_pid7na)[1]] <- "Independent, lean Republican"
m1_predvalues_cograc$Category[m1_predvalues_cograc$z_pid7na == median(Data$z_pid7na, na.rm=T)] <- "Independent"
m1_predvalues_cograc$Category <- as.factor(m1_predvalues_cograc$Category)
m1_predvalues_cograc$Category <- factor(m1_predvalues_cograc$Category,
levels(m1_predvalues_cograc$Category)[c(3,1,2)])
ggplot(m1_predvalues_cograc, aes(x = famincr, y = pp)) +
theme_steve()
ggplot(m1_predvalues_cograc, aes(x = z_lcograc, y = pp)) +
theme_steve()
summary(m1_predvalues_cograc$z_lcograc)
ggplot(m1_predvalues_cograc, aes(x = z_lcograc, y = pp)) +
theme_steve() +
geom_errorbar(aes(ymin = lb, ymax = ub), alpha = 0.5, linetype = 1, width=.25) +
geom_line(aes(colour = Category, linetype = Category), size = 1) +
geom_point(aes(colour = Category)) +
#  geom_line(aes(x=z_age), size = 1, color="red", linetype="dashed") +
ylab("Predicted Probability of a Trump Vote") +
xlab("Range of Family Income") +
theme(legend.position="bottom") +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by=.1)) +
scale_x_continuous(breaks=c(seq(-.75, 1.25, by=.25)), limits=c(-.75, 1.25)) +
geom_hline(aes(yintercept=.5), linetype="dashed") +
ggtitle("Vote for Trump (All Voters, by Family Income)")
m1_newdat_cograc <- with(Data,
data.frame(z_age=0,
"I(z_age^2)"=0,
female=1,
collegeed=0, z_famincr=0,
"I(z_famincr^2)"=0,black=0,
hisplat=0, otherrace=0,
z_pid7na=c(rep(unique(Data$z_pid7na)[7], 300),
rep(median(Data$z_pid7na, na.rm=T), 300),
rep(unique(Data$z_pid7na)[1], 300)),
z_ideo=median(Data$z_ideo, na.rm=TRUE),
z_lrelig=0,
z_lcograc=rep(seq(min(z_lcograc, na.rm=T), max(z_lcograc, na.rm=T), length.out=300), 3),
z_lemprac=0
)
)
m1_predvalues_cograc <- cbind(m1_newdat_cograc, predictSE(M1, newdata = m1_newdat_cograc,
type = "link", se.fit = TRUE, re.form=NA))
m1_predvalues_cograc$pp <- with(m1_predvalues_cograc, plogis(fit))
m1_predvalues_cograc$lb <- with(m1_predvalues_cograc, plogis(fit - (1.96 * se.fit)))
m1_predvalues_cograc$ub <- with(m1_predvalues_cograc, plogis(fit + (1.96 * se.fit)))
m1_predvalues_cograc$Category <- NA
m1_predvalues_cograc$Category[m1_predvalues_cograc$z_pid7na == unique(Data$z_pid7na)[7]] <- "Independent, lean Democrat"
m1_predvalues_cograc$Category[m1_predvalues_cograc$z_pid7na == unique(Data$z_pid7na)[1]] <- "Independent, lean Republican"
m1_predvalues_cograc$Category[m1_predvalues_cograc$z_pid7na == median(Data$z_pid7na, na.rm=T)] <- "Independent"
m1_predvalues_cograc$Category <- as.factor(m1_predvalues_cograc$Category)
m1_predvalues_cograc$Category <- factor(m1_predvalues_cograc$Category,
levels(m1_predvalues_cograc$Category)[c(3,1,2)])
ggplot(m1_predvalues_cograc, aes(x = z_lcograc, y = pp)) +
theme_steve() +
geom_errorbar(aes(ymin = lb, ymax = ub), alpha = 0.3, linetype = 1) +
geom_line(aes(colour = Category, linetype = Category), size = 1) +
geom_point(aes(colour = Category)) +
#  geom_line(aes(x=z_age), size = 1, color="red", linetype="dashed") +
ylab("Predicted Probability of a Trump Vote") +
xlab("Range of Cognitive Racism") +
theme(legend.position="bottom") +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by=.1)) +
scale_x_continuous(breaks=c(seq(-.75, 1.25, by=.25)), limits=c(-.75, 1.25)) +
geom_hline(aes(yintercept=.5), linetype="dashed") +
ggtitle("Vote for Trump (All Voters, by Cognitive Racism)")
unique(Data$z_pid7na)
unique(Data$pid7na)
m1_newdat_cograc <- with(Data,
data.frame(z_age=0,
"I(z_age^2)"=0,
female=1,
collegeed=0, z_famincr=0,
"I(z_famincr^2)"=0,black=0,
hisplat=0, otherrace=0,
z_pid7na=c(rep(unique(Data$z_pid7na)[4], 300),
rep(unique(Data$z_pid7na)[7], 300),
rep(median(Data$z_pid7na, na.rm=T), 300),
rep(unique(Data$z_pid7na)[1], 300),
rep(unique(Data$z_pid7na)[5], 300),),
z_ideo=median(Data$z_ideo, na.rm=TRUE),
z_lrelig=0,
z_lcograc=rep(seq(min(z_lcograc, na.rm=T), max(z_lcograc, na.rm=T), length.out=300), 3),
z_lemprac=0
)
)
m1_newdat_cograc <- with(Data,
data.frame(z_age=0,
"I(z_age^2)"=0,
female=1,
collegeed=0, z_famincr=0,
"I(z_famincr^2)"=0,black=0,
hisplat=0, otherrace=0,
z_pid7na=c(rep(unique(Data$z_pid7na)[4], 300),
rep(unique(Data$z_pid7na)[7], 300),
rep(median(Data$z_pid7na, na.rm=T), 300),
rep(unique(Data$z_pid7na)[1], 300),
rep(unique(Data$z_pid7na)[5], 300)),
z_ideo=median(Data$z_ideo, na.rm=TRUE),
z_lrelig=0,
z_lcograc=rep(seq(min(z_lcograc, na.rm=T), max(z_lcograc, na.rm=T), length.out=300), 3),
z_lemprac=0
)
)
m1_newdat_cograc <- with(Data,
data.frame(z_age=0,
"I(z_age^2)"=0,
female=1,
collegeed=0, z_famincr=0,
"I(z_famincr^2)"=0,black=0,
hisplat=0, otherrace=0,
z_pid7na=c(rep(unique(Data$z_pid7na)[4], 300),
rep(unique(Data$z_pid7na)[7], 300),
rep(median(Data$z_pid7na, na.rm=T), 300),
rep(unique(Data$z_pid7na)[1], 300),
rep(unique(Data$z_pid7na)[5], 300)),
z_ideo=median(Data$z_ideo, na.rm=TRUE),
z_lrelig=0,
z_lcograc=rep(seq(min(z_lcograc, na.rm=T), max(z_lcograc, na.rm=T), length.out=300), 3),
z_lemprac=0
)
)
m1_newdat_cograc <- with(Data,
data.frame(z_age=0,
"I(z_age^2)"=0,
female=1,
collegeed=0, z_famincr=0,
"I(z_famincr^2)"=0,black=0,
hisplat=0, otherrace=0,
z_pid7na=c(rep(unique(Data$z_pid7na)[4], 300),
rep(unique(Data$z_pid7na)[7], 300),
rep(median(Data$z_pid7na, na.rm=T), 300),
rep(unique(Data$z_pid7na)[1], 300),
rep(unique(Data$z_pid7na)[5], 300)),
z_ideo=median(Data$z_ideo, na.rm=TRUE),
z_lrelig=0,
z_lcograc=rep(seq(min(z_lcograc, na.rm=T), max(z_lcograc, na.rm=T), length.out=300), 5),
z_lemprac=0
)
)
m1_predvalues_cograc <- cbind(m1_newdat_cograc, predictSE(M1, newdata = m1_newdat_cograc,
type = "link", se.fit = TRUE, re.form=NA))
m1_predvalues_cograc$pp <- with(m1_predvalues_cograc, plogis(fit))
m1_predvalues_cograc$lb <- with(m1_predvalues_cograc, plogis(fit - (1.96 * se.fit)))
m1_predvalues_cograc$ub <- with(m1_predvalues_cograc, plogis(fit + (1.96 * se.fit)))
m1_predvalues_cograc$Category <- NA
unique(Data$pid7na)
m1_predvalues_cograc$Category <- NA
m1_predvalues_cograc$Category[m1_predvalues_cograc$z_pid7na == unique(Data$z_pid7na)[7]] <- "Independent, lean Democrat"
m1_predvalues_cograc$Category[m1_predvalues_cograc$z_pid7na == unique(Data$z_pid7na)[1]] <- "Independent, lean Republican"
m1_predvalues_cograc$Category[m1_predvalues_cograc$z_pid7na == median(Data$z_pid7na, na.rm=T)] <- "Independent"
m1_predvalues_cograc$Category[m1_predvalues_cograc$z_pid7na == unique(Data$z_pid7na)[4]] <- "Not strong Democrat"
m1_predvalues_cograc$Category[m1_predvalues_cograc$z_pid7na == unique(Data$z_pid7na)[5]] <- "Not strong Republican"
ggplot(m1_predvalues_cograc, aes(x = z_lcograc, y = pp)) +
theme_steve() +
geom_errorbar(aes(ymin = lb, ymax = ub), alpha = 0.3, linetype = 1) +
geom_line(aes(colour = Category, linetype = Category), size = 1) +
geom_point(aes(colour = Category)) +
#  geom_line(aes(x=z_age), size = 1, color="red", linetype="dashed") +
ylab("Predicted Probability of a Trump Vote") +
xlab("Range of Cognitive Racism") +
theme(legend.position="bottom") +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by=.1)) +
scale_x_continuous(breaks=c(seq(-.75, 1.25, by=.25)), limits=c(-.75, 1.25)) +
geom_hline(aes(yintercept=.5), linetype="dashed") +
ggtitle("Vote for Trump (All Voters, by Cognitive Racism)")
M5 <- glmer(votetrump ~ z_age + I(z_age^2) + female + collegeed +
z_famincr + I(z_famincr^2) +
black + hisplat + otherrace +
z_pid7na*z_lcograc + z_ideo +
z_lrelig +
z_lcograc + z_lemprac + (1 | state),
data=Data, family=binomial(link="logit"))
summary(M5)
m1_predvalues_cograc$Category <- as.factor(m1_predvalues_cograc$Category)
levels(m1_predvalues_cograc$Category)
m1_predvalues_cograc$Category <- factor(m1_predvalues_cograc$Category,
levels(m1_predvalues_cograc$Category)[c(5,3,1,2,4)])
ggplot(m1_predvalues_cograc, aes(x = z_lcograc, y = pp)) +
theme_steve() +
geom_errorbar(aes(ymin = lb, ymax = ub), alpha = 0.3, linetype = 1) +
geom_line(aes(colour = Category, linetype = Category), size = 1) +
geom_point(aes(colour = Category)) +
#  geom_line(aes(x=z_age), size = 1, color="red", linetype="dashed") +
ylab("Predicted Probability of a Trump Vote") +
xlab("Range of Cognitive Racism") +
theme(legend.position="bottom") +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by=.1)) +
scale_x_continuous(breaks=c(seq(-.75, 1.25, by=.25)), limits=c(-.75, 1.25)) +
geom_hline(aes(yintercept=.5), linetype="dashed") +
ggtitle("Vote for Trump (All Voters, by Cognitive Racism)")
ggplot(m1_predvalues_cograc, aes(x = z_lcograc, y = pp)) +
theme_steve() +
geom_errorbar(aes(ymin = lb, ymax = ub), alpha = 0.3, linetype = 1) +
geom_line(aes(colour = Category, linetype = Category), size = 1) +
geom_point(aes(colour = Category)) +
#  geom_line(aes(x=z_age), size = 1, color="red", linetype="dashed") +
ylab("Predicted Probability of a Trump Vote") +
xlab("Range of Cognitive Racism") +
theme(legend.position="bottom") +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by=.1)) +
scale_x_continuous(breaks=c(seq(-.75, 1.25, by=.25)), limits=c(-.75, 1.25)) +
geom_hline(aes(yintercept=.5), linetype="dashed") +
ggtitle("Vote for Trump (All Voters, by Cognitive Racism)") +
scale_colour_manual(values= c('#0023a0', '#f9a635', '#bebec0')
m2_newdat_age <- with(Data,
data.frame(z_age=seq(min(z_age), max(z_age), length.out=300),
female=1,
collegeed=0, z_famincr=0,
"I(z_famincr^2)"=0,black=0,
hisplat=0, otherrace=0,
z_pid7na=median(Data$z_pid7na, na.rm=T),
z_ideo=median(Data$z_ideo, na.rm=TRUE),
z_lrelig=0, z_lcograc=0,
z_lemprac=0
)
)
m2_newdat_age$"I(z_age^2)" <- with(m2_newdat_age, z_age^2)
m2_predvalues_age <- cbind(m2_newdat_age, predictSE(M2, newdata = m2_newdat_age,
type = "link", se.fit = TRUE, re.form=NA))
m2_predvalues_age$pp <- with(m2_predvalues_age, plogis(fit))
m2_predvalues_age$lb <- with(m2_predvalues_age, plogis(fit - (1.96 * se.fit)))
m2_predvalues_age$ub <- with(m2_predvalues_age, plogis(fit + (1.96 * se.fit)))
m2_age_p <- ggplot(m2_predvalues_age, aes(x = z_age, y = pp)) +
theme_steve() +
geom_errorbar(aes(ymin = lb, ymax = ub), alpha = 0.3, linetype = 1) +
geom_line(aes(x=z_age), size = 1, color="red", linetype="dashed") +
ylab("Predicted Probability of a Trump Vote") +
xlab("Range of Age (Scaled)") +
theme(legend.position="bottom") +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by=.1)) +
scale_x_continuous(breaks=c(seq(-.9,1.6, by=.1)), limits=c(-.9,1.6)) +
geom_hline(aes(yintercept=.5), linetype="dashed") +
ggtitle("Vote for Trump (White Voters)")
m3_newdat_age <- with(Data,
data.frame(z_age=seq(min(z_age), max(z_age), length.out=300),
female=1,
collegeed=0, z_famincr=0,
"I(z_famincr^2)"=0,black=0,
hisplat=0, otherrace=0,
z_pid7na=median(Data$z_pid7na, na.rm=T),
z_ideo=median(Data$z_ideo, na.rm=TRUE),
z_lrelig=0, z_lcograc=0,
z_lemprac=0
)
)
m3_newdat_age$"I(z_age^2)" <- with(m3_newdat_age, z_age^2)
m3_predvalues_age <- cbind(m3_newdat_age, predictSE(M3, newdata = m3_newdat_age,
type = "link", se.fit = TRUE, re.form=NA))
m3_predvalues_age$pp <- with(m3_predvalues_age, plogis(fit))
m3_predvalues_age$lb <- with(m3_predvalues_age, plogis(fit - (1.96 * se.fit)))
m3_predvalues_age$ub <- with(m3_predvalues_age, plogis(fit + (1.96 * se.fit)))
m3_age_p <- ggplot(m3_predvalues_age, aes(x = z_age, y = pp)) +
theme_steve() +
geom_errorbar(aes(ymin = lb, ymax = ub), alpha = 0.3, linetype = 1) +
geom_line(aes(x=z_age), size = 1, color="red", linetype="dashed") +
ylab("Predicted Probability of a Trump Vote") +
xlab("Range of Age (Scaled)") +
theme(legend.position="bottom") +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by=.1)) +
scale_x_continuous(breaks=c(seq(-.9,1.6, by=.1)), limits=c(-.9,1.6)) +
geom_hline(aes(yintercept=.5), linetype="dashed") +
ggtitle("Vote Switch (Obama to Trump)")
ggplot(m1_predvalues_cograc, aes(x = z_lcograc, y = pp)) +
theme_steve() +
geom_errorbar(aes(ymin = lb, ymax = ub), alpha = 0.3, linetype = 1) +
geom_line(aes(colour = Category, linetype = Category), size = 1) +
geom_point(aes(colour = Category)) +
#  geom_line(aes(x=z_age), size = 1, color="red", linetype="dashed") +
ylab("Predicted Probability of a Trump Vote") +
xlab("Range of Cognitive Racism") +
theme(legend.position="bottom") +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by=.1)) +
scale_x_continuous(breaks=c(seq(-.75, 1.25, by=.25)), limits=c(-.75, 1.25)) +
geom_hline(aes(yintercept=.5), linetype="dashed") +
ggtitle("Vote for Trump (All Voters, by Cognitive Racism)") +
scale_colour_manual(values= c('#0023a0', '#f9a635', '#bebec0'))
ggplot(m1_predvalues_cograc, aes(x = z_lcograc, y = pp)) +
theme_steve() +
geom_errorbar(aes(ymin = lb, ymax = ub), alpha = 0.3, linetype = 1) +
geom_line(aes(colour = Category, linetype = Category), size = 1) +
geom_point(aes(colour = Category)) +
#  geom_line(aes(x=z_age), size = 1, color="red", linetype="dashed") +
ylab("Predicted Probability of a Trump Vote") +
xlab("Range of Cognitive Racism") +
theme(legend.position="bottom") +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by=.1)) +
scale_x_continuous(breaks=c(seq(-.75, 1.25, by=.25)), limits=c(-.75, 1.25)) +
geom_hline(aes(yintercept=.5), linetype="dashed") +
ggtitle("Vote for Trump (All Voters, by Cognitive Racism)") +
scale_colour_manual(values= c('#0023a0', '#f9a635', '#bebec0', '#ffffff', '#000000'))
ggplot(m1_predvalues_cograc, aes(x = z_lcograc, y = pp)) +
theme_steve() +
geom_errorbar(aes(ymin = lb, ymax = ub), alpha = 0.3, linetype = 1) +
geom_line(aes(colour = Category, linetype = Category), size = 1) +
geom_point(aes(colour = Category)) +
#  geom_line(aes(x=z_age), size = 1, color="red", linetype="dashed") +
ylab("Predicted Probability of a Trump Vote") +
xlab("Range of Cognitive Racism") +
theme(legend.position="bottom") +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by=.1)) +
scale_x_continuous(breaks=c(seq(-.75, 1.25, by=.25)), limits=c(-.75, 1.25)) +
geom_hline(aes(yintercept=.5), linetype="dashed") +
ggtitle("Vote for Trump (All Voters, by Cognitive Racism)") +
scale_colour_manual(values= c('#C61600', '#f9a635', '#bebec0', '#ffffff', '#0023a0'))
ggplot(m1_predvalues_cograc, aes(x = z_lcograc, y = pp)) +
theme_steve() +
geom_errorbar(aes(ymin = lb, ymax = ub), alpha = 0.3, linetype = 1) +
geom_line(aes(colour = Category, linetype = Category), size = 1) +
geom_point(aes(colour = Category)) +
#  geom_line(aes(x=z_age), size = 1, color="red", linetype="dashed") +
ylab("Predicted Probability of a Trump Vote") +
xlab("Range of Cognitive Racism") +
theme(legend.position="bottom") +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by=.1)) +
scale_x_continuous(breaks=c(seq(-.75, 1.25, by=.25)), limits=c(-.75, 1.25)) +
geom_hline(aes(yintercept=.5), linetype="dashed") +
ggtitle("Vote for Trump (All Voters, by Cognitive Racism)") +
scale_colour_manual(values= c('#C61600', '#F55F4D', '#bebec0', '#ffffff', '#0023a0'))
ggplot(m1_predvalues_cograc, aes(x = z_lcograc, y = pp)) +
theme_steve() +
geom_errorbar(aes(ymin = lb, ymax = ub), alpha = 0.3, linetype = 1) +
geom_line(aes(colour = Category, linetype = Category), size = 1) +
geom_point(aes(colour = Category)) +
#  geom_line(aes(x=z_age), size = 1, color="red", linetype="dashed") +
ylab("Predicted Probability of a Trump Vote") +
xlab("Range of Cognitive Racism") +
theme(legend.position="bottom") +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by=.1)) +
scale_x_continuous(breaks=c(seq(-.75, 1.25, by=.25)), limits=c(-.75, 1.25)) +
geom_hline(aes(yintercept=.5), linetype="dashed") +
ggtitle("Vote for Trump (All Voters, by Cognitive Racism)") +
scale_colour_manual(values= c('#C61600', '#F55F4D', '#bebec0', '#6281EF', '#0023a0'))
install.packages("EstCRM", dependencies = FALSE)
library(EstCRM)
data(EPIA)
summary(EPIA)
max.item <- c(112,112,112,112,112)
min.item <- c(0,0,0,0,0)
min.item
max.EMCycle=200
converge=.01
CRM <- EstCRMitem(EPIA, max.item, min.item, max.EMCycle, converge)
summary(CRM)
CRM
CRM$data
head(EPIA)
head(CRM$data)
CRM$param
CRM$descriptive
CRM$std.err
CRM <- EstCRMitem(EPIA, max.item, min.item, max.EMCycle = 500, converge = 0.01)
par <- CRM$param
##Estimate the person parameters
CRMthetas <- EstCRMperson(EPIA,par,min.item,max.item)
theta.par <- CRMthetas$thetas
theta.par
nrow(EPIA)
head(EPIA)
EPIA <- as.data.frame(lapply(EPIA, function(cc) cc[ sample(c(TRUE, NA), prob = c(0.85, 0.15), size = length(cc), replace = TRUE) ]))
summary(EPIA)
CRM <- EstCRMitem(EPIA, max.item, min.item, max.EMCycle = 500, converge = 0.01)
par <- CRM$param
##Estimate the person parameters
CRMthetas <- EstCRMperson(EPIA,par,min.item,max.item)
theta.par <- CRMthetas$thetas
theta.par
summary(theta.par)
CRM <- EstCRMitem(EPIA, max.item, min.item, max.EMCycle = 500, converge = 0.01)
par <- CRM$param
##Estimate the person parameters
CRMthetas <- EstCRMperson(EPIA,par,min.item,max.item)
theta.par <- CRMthetas$thetas
summary(theta.par)
summary(EPIA)
sqldf("select * from EPIA where Item.1 IS NULL")
library(sqldf)
sqldf("select * from EPIA where Item.1 IS NULL")
sqldf("select * from EPIA where 'Item.1' IS NULL")
sqldf("select * from EPIA where 'Item.2' IS NULL")
data(EPIA)
EPIA <- as.data.frame(lapply(EPIA, function(cc) cc[ sample(c(TRUE, NA), prob = c(0.95, 0.05), size = length(cc), replace = TRUE) ]))
CRM <- EstCRMitem(EPIA, max.item, min.item, max.EMCycle = 500, converge = 0.01)
par <- CRM$param
##Estimate the person parameters
CRMthetas <- EstCRMperson(EPIA,par,min.item,max.item)
theta.par <- CRMthetas$thetas
summary(theta.par)
summary(CRMthetas)
CRMthetas
